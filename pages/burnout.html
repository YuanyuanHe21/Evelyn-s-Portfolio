<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Failure - Burnout</title>
    
    <style>
        /* =========================================
           1. å­—ä½“ä¸åŸºç¡€è®¾ç½®
           ========================================= */
        @font-face {
            font-family: 'InstrumentSans-Regular';
            src: url('../assets/fonts/InstrumentSans-Regular.ttf') format('truetype');
        }
        @font-face {
            font-family: 'PuHuiTi';
            src: url('../assets/fonts/Alibaba-PuHuiTi-Light.otf') format('opentype');
        }
        @font-face {
            font-family: 'BebasNeue';
            src: url('../assets/fonts/BebasNeueRegular-gxj83.ttf') format('truetype');
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #f4f4f4; 
            font-family: 'InstrumentSans-Regular', sans-serif;
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            user-select: none;
            cursor: default;
        }

        /* å“ç‰Œè‰²å˜é‡ */
        :root {
            --color-pink: #f9a7e3;
            --color-mint: #0ffdbb;
            --color-black: #000000;
        }

        /* èƒŒæ™¯è£…é¥°æ–‡å­— */
        .bsod-bg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            text-align: center;
            color: rgba(0,0,0,0.03);
            font-family: 'BebasNeue', sans-serif;
            font-size: 200px;
            line-height: 0.9;
            z-index: 0;
            pointer-events: none;
            white-space: nowrap;
            overflow: hidden;
        }

        /* å¯¼èˆª */
        .nav-back {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 1000;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
            color: #000; 
            background: #fff;
            padding: 10px 20px;
            border: 3px solid #000;
            box-shadow: 4px 4px 0px #000;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .nav-back:hover { 
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px #000;
        }

        /* =========================================
           2. ç°ä»£æ³¢æ™®é£æ ¼çª—å£ (Mini Version)
           ========================================= */
        .window {
            position: absolute;
            background: #fff;
            border: 2px solid #000; /* è¾¹æ¡†ç¨å¾®ç»†ä¸€ç‚¹ç‚¹ */
            box-shadow: 6px 6px 0px rgba(0,0,0,0.15); /* é˜´å½±ä¹Ÿç¨å¾®æ”¶æ•› */
            display: flex;
            flex-direction: column;
            width: 180px; /* ğŸ”´ ä¿®æ”¹ï¼šå®½åº¦å˜å° */
            z-index: 10;
            transition: transform 0.05s;
        }

        .title-bar {
            padding: 4px 8px; /* ğŸ”´ ä¿®æ”¹ï¼šå†…è¾¹è·å‡å° */
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            border-bottom: 2px solid #000;
        }

        /* æ ‡é¢˜æ é¢œè‰² */
        .bg-pink { background-color: var(--color-pink); }
        .bg-mint { background-color: var(--color-mint); }
        .bg-black { background-color: var(--color-black); color: #fff; }
        .bg-black .title-text { color: #fff; }
        .bg-black .btn-close { border-color: #fff; color: #fff; }

        .title-text {
            color: #000;
            font-family: 'BebasNeue', sans-serif;
            font-size: 14px; /* ğŸ”´ ä¿®æ”¹ï¼šå­—å·å˜å° */
            letter-spacing: 1px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .btn-close {
            width: 16px; /* ğŸ”´ ä¿®æ”¹ï¼šæŒ‰é’®å˜å° */
            height: 16px;
            border: 2px solid #000;
            font-size: 12px;
            line-height: 12px;
            text-align: center;
            font-weight: bold;
            cursor: pointer;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
        }
        .btn-close:hover {
            background: #000;
            color: #fff;
        }

        .window-content {
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #fff;
            min-height: 100px; /* ğŸ”´ ä¿®æ”¹ï¼šæœ€å°é«˜åº¦å˜å° */
            position: relative;
            overflow: hidden;
        }

        .window-content img {
            width: 100%;
            height: auto;
            display: block;
            pointer-events: none;
        }

        /* æ‹–æ‹½æ®‹å½± */
        .trail {
            position: absolute;
            opacity: 0.3;
            z-index: 5;
            pointer-events: none;
            box-shadow: none !important; 
            border: 2px solid #000 !important;
            background: transparent !important;
        }
        .trail .title-bar { border-bottom: 2px solid #000; opacity: 0.5; }
        .trail .window-content { opacity: 0.2; }

        /* åº•éƒ¨ä»»åŠ¡æ  */
        .taskbar {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: auto;
            padding: 10px 20px;
            background: #fff;
            border: 3px solid #000;
            box-shadow: 6px 6px 0px #000;
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 2000;
            border-radius: 50px;
        }
        
        .start-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 20px;
            background: #000;
            color: #fff;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            font-family: 'InstrumentSans-Regular', sans-serif;
            transition: transform 0.1s;
        }
        .start-btn:active { transform: scale(0.95); }

        .clock-display {
            font-family: 'BebasNeue', sans-serif; 
            font-size: 24px;
            letter-spacing: 1px;
        }

        /* é”™è¯¯å¼¹çª—æ ·å¼ */
        .error-msg {
            font-family: 'InstrumentSans-Regular', sans-serif;
            font-weight: bold;
            font-size: 16px; /* ğŸ”´ ä¿®æ”¹ï¼šå­—å·å˜å° */
            text-align: center;
            padding: 20px;
        }

    </style>
</head>
<body>

    <!-- è¿”å›æŒ‰é’® -->
    <a href="../index.html" class="nav-back">â† ESCAPE BURNOUT</a>

    <!-- èƒŒæ™¯è£…é¥°æ–‡å­— -->
    <div class="bsod-bg">
        SYSTEM OVERLOAD<br>
        MENTAL CRASH<br>
        ERROR 404
    </div>

    <!-- æ¡Œé¢åŒºåŸŸ -->
    <div id="desktop">
        <!-- åˆå§‹çª—å£ï¼šè¿™é‡Œä¸å†æ”¾è§†é¢‘çª—å£ -->
        
        <!-- åˆå§‹çª—å£ 1: çº¯æ–‡æœ¬æŠ¥é”™ -->
        <div class="window" id="error-init" style="left: 50vw; top: 30vh; width: 200px;">
            <div class="title-bar bg-black">
                <span class="title-text">WARNING</span>
                <div class="btn-close">Ã—</div>
            </div>
            <div class="window-content">
                <div class="error-msg">
                    Brain.exe<br>Stopped Working.
                </div>
            </div>
        </div>

        <!-- åˆå§‹çª—å£ 2: å›¾ç‰‡ (éšæœº) -->
        <div class="window" id="meme-init" style="left: 30vw; top: 40vh;">
            <div class="title-bar bg-mint">
                <span class="title-text">My_Brain.png</span>
                <div class="btn-close">Ã—</div>
            </div>
            <div class="window-content">
                <!-- å ä½ç¬¦ï¼ŒJSåŠ è½½åä¼šè‡ªåŠ¨éšæœºç”Ÿæˆæ›´å¤š -->
                <img src="https://placehold.co/180x150/fff/000?text=LOADING..." alt="Meme">
            </div>
        </div>

    </div>

    <!-- åº•éƒ¨ä»»åŠ¡æ  -->
    <div class="taskbar">
        <div class="start-btn" onclick="addRandomWindow()">
            <span>ğŸ”¥</span> ADD CHAOS
        </div>
        <div class="clock-display" id="clock">00:00</div>
    </div>

    <!-- éŸ³æ•ˆ -->
    <audio id="sfx-error" src="../assets/audio/error.mp3"></audio>

    <script>
        const desktop = document.getElementById('desktop');
        const sfxError = document.getElementById('sfx-error');
        let highestZ = 100; 

        // é¢œè‰²ç±»æ•°ç»„
        const headerColors = ['bg-pink', 'bg-mint', 'bg-black'];

        // 1. åˆå§‹åŒ–çª—å£åŠŸèƒ½
        function initWindows() {
            const windows = document.querySelectorAll('.window');
            windows.forEach(win => setupWindow(win));
        }

        function setupWindow(win) {
            const titleBar = win.querySelector('.title-bar');
            const closeBtn = win.querySelector('.btn-close');

            // ç½®é¡¶é€»è¾‘
            win.addEventListener('mousedown', () => {
                highestZ++;
                win.style.zIndex = highestZ;
            });

            // æ‹–æ‹½é€»è¾‘
            let isDragging = false;
            let startX, startY, initialLeft, initialTop;
            let trailInterval;

            titleBar.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                initialLeft = win.offsetLeft;
                initialTop = win.offsetTop;
                
                highestZ++;
                win.style.zIndex = highestZ;
                
                // æ®‹å½±ç”Ÿæˆ
                trailInterval = setInterval(() => createTrail(win), 80); 
                
                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });

            function onMouseMove(e) {
                if (!isDragging) return;
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                win.style.left = `${initialLeft + dx}px`;
                win.style.top = `${initialTop + dy}px`;
            }

            function onMouseUp() {
                isDragging = false;
                clearInterval(trailInterval);
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
            }

            // å…³é—­æŒ‰é’®é€»è¾‘
            closeBtn.addEventListener('click', (e) => {
                e.stopPropagation(); 
                
                if(sfxError) {
                    sfxError.currentTime = 0;
                    sfxError.play().catch(()=>{});
                }

                // å‰§çƒˆéœ‡åŠ¨
                win.style.transform = `translate(${Math.random()*20-10}px, ${Math.random()*20-10}px) rotate(${Math.random()*10-5}deg)`;
                setTimeout(() => win.style.transform = 'none', 150);

                // å¿…ç„¶ç”Ÿæˆæ–°çª—å£
                addRandomWindow();
            });
        }

        // 2. æ®‹å½±ç”Ÿæˆ
        function createTrail(targetWin) {
            const rect = targetWin.getBoundingClientRect();
            const clone = targetWin.cloneNode(true); 
            
            clone.classList.add('trail');
            clone.style.left = `${rect.left}px`;
            clone.style.top = `${rect.top}px`;
            clone.style.width = `${rect.width}px`;
            clone.style.height = `${rect.height}px`;
            clone.style.zIndex = targetWin.style.zIndex - 1;
            clone.id = '';
            
            // ç§»é™¤å¯èƒ½å­˜åœ¨çš„è§†é¢‘å†…å®¹
            const video = clone.querySelector('video');
            if(video) video.remove();

            desktop.appendChild(clone);

            setTimeout(() => {
                clone.style.transition = 'opacity 0.8s';
                clone.style.opacity = 0;
                setTimeout(() => clone.remove(), 800);
            }, 50);
        }

        // 3. éšæœºç”Ÿæˆæ–°çª—å£
        function addRandomWindow() {
            const win = document.createElement('div');
            win.classList.add('window');
            
            // ğŸ”´ éšæœºèŒƒå›´ï¼šå±å¹•å®‰å…¨åŒºåŸŸ
            const x = Math.random() * (window.innerWidth - 200) + 20;
            const y = Math.random() * (window.innerHeight - 200) + 20;
            
            win.style.left = `${x}px`;
            win.style.top = `${y}px`;
            win.style.zIndex = ++highestZ;

            const randomColorClass = headerColors[Math.floor(Math.random() * headerColors.length)];
            
            const isText = Math.random() > 0.8;
            
            if (isText) {
                const phrases = ["404 BRAIN NOT FOUND", "PLEASE SLEEP", "DEADLINE IS COMING", "CTRL+Z", "HELP ME", "NOT RESPONDING", "FATAL ERROR", "SYSTEM CRASH"];
                const phrase = phrases[Math.floor(Math.random() * phrases.length)];
                
                win.innerHTML = `
                    <div class="title-bar ${randomColorClass}">
                        <span class="title-text">ERROR</span>
                        <div class="btn-close">Ã—</div>
                    </div>
                    <div class="window-content">
                        <div class="error-msg">${phrase}</div>
                    </div>
                `;
            } else {
                // éšæœºé€‰æ‹© meme-01.jpg åˆ° meme-18.jpg
                const totalMemes = 18; 
                const randomImgNum = Math.floor(Math.random() * totalMemes) + 1;
                const paddedNum = randomImgNum.toString().padStart(2, '0'); 
                
                win.innerHTML = `
                    <div class="title-bar ${randomColorClass}">
                        <span class="title-text">meme_${paddedNum}.jpg</span>
                        <div class="btn-close">Ã—</div>
                    </div>
                    <div class="window-content">
                        <img src="../assets/images/meme-${paddedNum}.jpg" alt="Meme ${paddedNum}" onerror="this.src='https://placehold.co/180x150/fff/000?text=MEME-${paddedNum}'">
                    </div>
                `;
            }

            desktop.appendChild(win);
            setupWindow(win);
        }

        // æ—¶é’Ÿ
        setInterval(() => {
            const now = new Date();
            document.getElementById('clock').innerText = 
                now.getHours().toString().padStart(2,'0') + ':' + 
                now.getMinutes().toString().padStart(2,'0');
        }, 1000);

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¼¹å‡º 3 ä¸ªçª—å£
        window.addEventListener('load', () => {
            initWindows();
            // å»¶æ—¶ä¸€ç‚¹å¼¹å‡ºæ›´å¤šï¼Œåˆ¶é€ èŠ‚å¥æ„Ÿ
            setTimeout(addRandomWindow, 300);
            setTimeout(addRandomWindow, 600);
            setTimeout(addRandomWindow, 900);
        });

    </script>
</body>
</html>